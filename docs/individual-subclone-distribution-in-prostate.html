<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>15 Individual subclone distribution in prostate | High clonal diversity and spatial genetic admixture in early prostate cancer and surrounding normal tissue</title>
  <meta name="description" content="15 Individual subclone distribution in prostate | High clonal diversity and spatial genetic admixture in early prostate cancer and surrounding normal tissue" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="15 Individual subclone distribution in prostate | High clonal diversity and spatial genetic admixture in early prostate cancer and surrounding normal tissue" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="15 Individual subclone distribution in prostate | High clonal diversity and spatial genetic admixture in early prostate cancer and surrounding normal tissue" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="subclonal-distribution-in-prostate.html"/>
<link rel="next" href="monster-cells.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="preprocessing.html"><a href="preprocessing.html"><i class="fa fa-check"></i><b>2</b> Preprocessing</a>
<ul>
<li class="chapter" data-level="2.1" data-path="preprocessing.html"><a href="preprocessing.html#demultiplexing-of-fastq-files"><i class="fa fa-check"></i><b>2.1</b> Demultiplexing of fastq files</a></li>
<li class="chapter" data-level="2.2" data-path="preprocessing.html"><a href="preprocessing.html#adapter-trimming"><i class="fa fa-check"></i><b>2.2</b> Adapter trimming</a></li>
<li class="chapter" data-level="2.3" data-path="preprocessing.html"><a href="preprocessing.html#aligning-of-cell-specific-fastq-files"><i class="fa fa-check"></i><b>2.3</b> Aligning of cell specific fastq files</a></li>
<li class="chapter" data-level="2.4" data-path="preprocessing.html"><a href="preprocessing.html#moving-barcodes-and-umis-to-bam-tags"><i class="fa fa-check"></i><b>2.4</b> Moving barcodes and UMIs to bam tags</a></li>
<li class="chapter" data-level="2.5" data-path="preprocessing.html"><a href="preprocessing.html#deduplication"><i class="fa fa-check"></i><b>2.5</b> Deduplication</a></li>
<li class="chapter" data-level="2.6" data-path="preprocessing.html"><a href="preprocessing.html#qc-summary"><i class="fa fa-check"></i><b>2.6</b> QC summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="copy-number-calling.html"><a href="copy-number-calling.html"><i class="fa fa-check"></i><b>3</b> Copy number calling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="copy-number-calling.html"><a href="copy-number-calling.html#transform-bam-files"><i class="fa fa-check"></i><b>3.1</b> Transform bam files</a></li>
<li class="chapter" data-level="3.2" data-path="copy-number-calling.html"><a href="copy-number-calling.html#count-reads"><i class="fa fa-check"></i><b>3.2</b> Count reads</a></li>
<li class="chapter" data-level="3.3" data-path="copy-number-calling.html"><a href="copy-number-calling.html#calling-copy-numbers"><i class="fa fa-check"></i><b>3.3</b> Calling copy numbers</a></li>
<li class="chapter" data-level="3.4" data-path="copy-number-calling.html"><a href="copy-number-calling.html#generate-plots"><i class="fa fa-check"></i><b>3.4</b> Generate plots</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="technical-validation-of-sccutseq.html"><a href="technical-validation-of-sccutseq.html"><i class="fa fa-check"></i><b>4</b> Technical validation of scCUTseq</a>
<ul>
<li class="chapter" data-level="4.1" data-path="technical-validation-of-sccutseq.html"><a href="technical-validation-of-sccutseq.html#duplication-rates-of-cutseq-vs-malbac"><i class="fa fa-check"></i><b>4.1</b> Duplication rates of CUTseq vs MALBAC</a></li>
<li class="chapter" data-level="4.2" data-path="technical-validation-of-sccutseq.html"><a href="technical-validation-of-sccutseq.html#pearson-correlation-malbac-scaling"><i class="fa fa-check"></i><b>4.2</b> Pearson correlation MALBAC scaling</a></li>
<li class="chapter" data-level="4.3" data-path="technical-validation-of-sccutseq.html"><a href="technical-validation-of-sccutseq.html#representative-sccutseq-and-smalbac-profiles-of-skbr3-cells"><i class="fa fa-check"></i><b>4.3</b> Representative scCUTseq and sMALBAC profiles of SKBR3 cells</a></li>
<li class="chapter" data-level="4.4" data-path="technical-validation-of-sccutseq.html"><a href="technical-validation-of-sccutseq.html#lorenz-curves-of-sccutseq-and-scaled-malbac"><i class="fa fa-check"></i><b>4.4</b> Lorenz curves of (sc)CUTseq and (scaled) MALBAC</a></li>
<li class="chapter" data-level="4.5" data-path="technical-validation-of-sccutseq.html"><a href="technical-validation-of-sccutseq.html#pearson-correlation-of-fixed-versus-live-skbr3-cells"><i class="fa fa-check"></i><b>4.5</b> Pearson correlation of fixed versus live SKBR3 cells</a></li>
<li class="chapter" data-level="4.6" data-path="technical-validation-of-sccutseq.html"><a href="technical-validation-of-sccutseq.html#genomewide-copy-number-profiles-of-cell-lines"><i class="fa fa-check"></i><b>4.6</b> Genomewide copy number profiles of cell lines</a></li>
<li class="chapter" data-level="4.7" data-path="technical-validation-of-sccutseq.html"><a href="technical-validation-of-sccutseq.html#cross-contamination-experiment-with-dm-and-hs"><i class="fa fa-check"></i><b>4.7</b> Cross-contamination experiment with Dm and Hs</a></li>
<li class="chapter" data-level="4.8" data-path="technical-validation-of-sccutseq.html"><a href="technical-validation-of-sccutseq.html#detection-of-crispr-induced-deletions"><i class="fa fa-check"></i><b>4.8</b> Detection of CRISPR induced deletions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="comparison-of-sccutseq-and-act.html"><a href="comparison-of-sccutseq-and-act.html"><i class="fa fa-check"></i><b>5</b> Comparison of scCUTseq and ACT</a>
<ul>
<li class="chapter" data-level="5.1" data-path="comparison-of-sccutseq-and-act.html"><a href="comparison-of-sccutseq-and-act.html#calculate-breadth-of-coverage"><i class="fa fa-check"></i><b>5.1</b> Calculate breadth of coverage</a></li>
<li class="chapter" data-level="5.2" data-path="comparison-of-sccutseq-and-act.html"><a href="comparison-of-sccutseq-and-act.html#calculate-overdispersion"><i class="fa fa-check"></i><b>5.2</b> Calculate overdispersion</a></li>
<li class="chapter" data-level="5.3" data-path="comparison-of-sccutseq-and-act.html"><a href="comparison-of-sccutseq-and-act.html#plot-genomewide-heatmaps-of-act-and-sccutseq-copynumber-profiles"><i class="fa fa-check"></i><b>5.3</b> Plot genomewide heatmaps of ACT and scCUTseq copynumber profiles</a></li>
<li class="chapter" data-level="5.4" data-path="comparison-of-sccutseq-and-act.html"><a href="comparison-of-sccutseq-and-act.html#plot-profile-plots-of-example-profiles"><i class="fa fa-check"></i><b>5.4</b> Plot profile plots of example profiles</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="spatially-resolved-single-cell-cna-profiling-across-the-prostate.html"><a href="spatially-resolved-single-cell-cna-profiling-across-the-prostate.html"><i class="fa fa-check"></i><b>6</b> Spatially resolved single-cell CNA profiling across the prostate</a>
<ul>
<li class="chapter" data-level="6.1" data-path="spatially-resolved-single-cell-cna-profiling-across-the-prostate.html"><a href="spatially-resolved-single-cell-cna-profiling-across-the-prostate.html#spatial-pathologist-annotation"><i class="fa fa-check"></i><b>6.1</b> Spatial pathologist annotation</a></li>
<li class="chapter" data-level="6.2" data-path="spatially-resolved-single-cell-cna-profiling-across-the-prostate.html"><a href="spatially-resolved-single-cell-cna-profiling-across-the-prostate.html#spatial-distribution-of-rnaseq-clusters-scnas-and-mutations-in-prostate"><i class="fa fa-check"></i><b>6.2</b> Spatial distribution of RNAseq clusters, SCNAs and mutations in prostate</a></li>
<li class="chapter" data-level="6.3" data-path="spatially-resolved-single-cell-cna-profiling-across-the-prostate.html"><a href="spatially-resolved-single-cell-cna-profiling-across-the-prostate.html#cell-type-distribution"><i class="fa fa-check"></i><b>6.3</b> Cell type distribution</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="random-forest-classification.html"><a href="random-forest-classification.html"><i class="fa fa-check"></i><b>7</b> Random forest classification</a>
<ul>
<li class="chapter" data-level="7.1" data-path="random-forest-classification.html"><a href="random-forest-classification.html#loading-in-data"><i class="fa fa-check"></i><b>7.1</b> Loading in data</a></li>
<li class="chapter" data-level="7.2" data-path="random-forest-classification.html"><a href="random-forest-classification.html#obtain-training-set-and-validation-set"><i class="fa fa-check"></i><b>7.2</b> Obtain training set and validation set</a></li>
<li class="chapter" data-level="7.3" data-path="random-forest-classification.html"><a href="random-forest-classification.html#training-the-model"><i class="fa fa-check"></i><b>7.3</b> Training the model</a></li>
<li class="chapter" data-level="7.4" data-path="random-forest-classification.html"><a href="random-forest-classification.html#validating-the-model"><i class="fa fa-check"></i><b>7.4</b> Validating the model</a></li>
<li class="chapter" data-level="7.5" data-path="random-forest-classification.html"><a href="random-forest-classification.html#plotting-number-of-cells-that-pass-qc"><i class="fa fa-check"></i><b>7.5</b> Plotting number of cells that pass QC</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="copy-number-profiles-of-brain-neurons-and-skeletal-muscle-cells.html"><a href="copy-number-profiles-of-brain-neurons-and-skeletal-muscle-cells.html"><i class="fa fa-check"></i><b>8</b> Copy number profiles of brain neurons and skeletal muscle cells</a>
<ul>
<li class="chapter" data-level="8.1" data-path="copy-number-profiles-of-brain-neurons-and-skeletal-muscle-cells.html"><a href="copy-number-profiles-of-brain-neurons-and-skeletal-muscle-cells.html#plot-genomewide-heatmaps"><i class="fa fa-check"></i><b>8.1</b> Plot genomewide heatmaps</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="copy-number-profiles-of-other-prostate-cancer-patients.html"><a href="copy-number-profiles-of-other-prostate-cancer-patients.html"><i class="fa fa-check"></i><b>9</b> Copy number profiles of other prostate cancer patients</a>
<ul>
<li class="chapter" data-level="9.1" data-path="copy-number-profiles-of-other-prostate-cancer-patients.html"><a href="copy-number-profiles-of-other-prostate-cancer-patients.html#plot-genomewide-heatmap"><i class="fa fa-check"></i><b>9.1</b> Plot genomewide heatmap</a></li>
<li class="chapter" data-level="9.2" data-path="copy-number-profiles-of-other-prostate-cancer-patients.html"><a href="copy-number-profiles-of-other-prostate-cancer-patients.html#plot-cell-type-distribution"><i class="fa fa-check"></i><b>9.2</b> Plot cell type distribution</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="nebnext-versus-sccutseq.html"><a href="nebnext-versus-sccutseq.html"><i class="fa fa-check"></i><b>10</b> NEBNext versus scCUTseq</a>
<ul>
<li class="chapter" data-level="10.1" data-path="nebnext-versus-sccutseq.html"><a href="nebnext-versus-sccutseq.html#validating-detected-deletions-using-bulk-nebnext-sequencing"><i class="fa fa-check"></i><b>10.1</b> Validating detected deletions using bulk NEBNext sequencing</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="whole-genome-sequencing-of-blood.html"><a href="whole-genome-sequencing-of-blood.html"><i class="fa fa-check"></i><b>11</b> Whole-Genome Sequencing of blood</a>
<ul>
<li class="chapter" data-level="11.1" data-path="whole-genome-sequencing-of-blood.html"><a href="whole-genome-sequencing-of-blood.html#plotting-wgs-data-for-p3-and-p6-blood"><i class="fa fa-check"></i><b>11.1</b> Plotting WGS data for P3 and P6 blood</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="clonal-analysis-pseudo-diploid-cells.html"><a href="clonal-analysis-pseudo-diploid-cells.html"><i class="fa fa-check"></i><b>12</b> Clonal analysis pseudo-diploid cells</a>
<ul>
<li class="chapter" data-level="12.1" data-path="clonal-analysis-pseudo-diploid-cells.html"><a href="clonal-analysis-pseudo-diploid-cells.html#running-medicc2"><i class="fa fa-check"></i><b>12.1</b> Running MEDICC2</a></li>
<li class="chapter" data-level="12.2" data-path="clonal-analysis-pseudo-diploid-cells.html"><a href="clonal-analysis-pseudo-diploid-cells.html#plot-medicc2-results"><i class="fa fa-check"></i><b>12.2</b> Plot MEDICC2 results</a></li>
<li class="chapter" data-level="12.3" data-path="clonal-analysis-pseudo-diploid-cells.html"><a href="clonal-analysis-pseudo-diploid-cells.html#identify-tumour-subclones"><i class="fa fa-check"></i><b>12.3</b> Identify tumour subclones</a></li>
<li class="chapter" data-level="12.4" data-path="clonal-analysis-pseudo-diploid-cells.html"><a href="clonal-analysis-pseudo-diploid-cells.html#calculate-scnas-per-subclones"><i class="fa fa-check"></i><b>12.4</b> Calculate SCNAs per subclones</a></li>
<li class="chapter" data-level="12.5" data-path="clonal-analysis-pseudo-diploid-cells.html"><a href="clonal-analysis-pseudo-diploid-cells.html#calculate-entropy-per-subclone"><i class="fa fa-check"></i><b>12.5</b> Calculate entropy per subclone</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="phylogenetic-analysis-of-breast-cancer.html"><a href="phylogenetic-analysis-of-breast-cancer.html"><i class="fa fa-check"></i><b>13</b> Phylogenetic analysis of breast cancer</a>
<ul>
<li class="chapter" data-level="13.1" data-path="phylogenetic-analysis-of-breast-cancer.html"><a href="phylogenetic-analysis-of-breast-cancer.html#performing-phylogenetic-analysis"><i class="fa fa-check"></i><b>13.1</b> Performing phylogenetic analysis</a></li>
<li class="chapter" data-level="13.2" data-path="phylogenetic-analysis-of-breast-cancer.html"><a href="phylogenetic-analysis-of-breast-cancer.html#plotting-phylogenetic-tree-and-heatmap"><i class="fa fa-check"></i><b>13.2</b> Plotting phylogenetic tree and heatmap</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="subclonal-distribution-in-prostate.html"><a href="subclonal-distribution-in-prostate.html"><i class="fa fa-check"></i><b>14</b> Subclonal distribution in prostate</a>
<ul>
<li class="chapter" data-level="14.1" data-path="subclonal-distribution-in-prostate.html"><a href="subclonal-distribution-in-prostate.html#plotting-spatial-subclonal-distribution"><i class="fa fa-check"></i><b>14.1</b> Plotting spatial subclonal distribution</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="individual-subclone-distribution-in-prostate.html"><a href="individual-subclone-distribution-in-prostate.html"><i class="fa fa-check"></i><b>15</b> Individual subclone distribution in prostate</a>
<ul>
<li class="chapter" data-level="15.1" data-path="individual-subclone-distribution-in-prostate.html"><a href="individual-subclone-distribution-in-prostate.html#plotting-individual-subclone-distribution"><i class="fa fa-check"></i><b>15.1</b> Plotting individual subclone distribution</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="monster-cells.html"><a href="monster-cells.html"><i class="fa fa-check"></i><b>16</b> Monster cells</a>
<ul>
<li class="chapter" data-level="16.1" data-path="monster-cells.html"><a href="monster-cells.html#clustering-copynumber-profiles"><i class="fa fa-check"></i><b>16.1</b> Clustering copynumber profiles</a></li>
<li class="chapter" data-level="16.2" data-path="monster-cells.html"><a href="monster-cells.html#plotting-genomewide-heatmaps"><i class="fa fa-check"></i><b>16.2</b> Plotting genomewide heatmaps</a></li>
<li class="chapter" data-level="16.3" data-path="monster-cells.html"><a href="monster-cells.html#plot-distribution"><i class="fa fa-check"></i><b>16.3</b> Plot distribution</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="validation-of-pseudodiploid-deletions.html"><a href="validation-of-pseudodiploid-deletions.html"><i class="fa fa-check"></i><b>17</b> Validation of pseudodiploid deletions</a></li>
<li class="chapter" data-level="18" data-path="trrfer-subclone-analysis.html"><a href="trrfer-subclone-analysis.html"><i class="fa fa-check"></i><b>18</b> TRR/FER subclone analysis</a>
<ul>
<li class="chapter" data-level="18.1" data-path="trrfer-subclone-analysis.html"><a href="trrfer-subclone-analysis.html#plotting-deleted-genes-from-trrfer-subclones"><i class="fa fa-check"></i><b>18.1</b> Plotting deleted genes from TRR/FER subclones</a></li>
<li class="chapter" data-level="18.2" data-path="trrfer-subclone-analysis.html"><a href="trrfer-subclone-analysis.html#co-deletions-of-tsgs"><i class="fa fa-check"></i><b>18.2</b> Co-deletions of TSGs</a></li>
<li class="chapter" data-level="18.3" data-path="trrfer-subclone-analysis.html"><a href="trrfer-subclone-analysis.html#tcga-deletion-analysis"><i class="fa fa-check"></i><b>18.3</b> TCGA deletion analysis</a></li>
<li class="chapter" data-level="18.4" data-path="trrfer-subclone-analysis.html"><a href="trrfer-subclone-analysis.html#targeted-sequencing-mutations"><i class="fa fa-check"></i><b>18.4</b> Targeted sequencing mutations</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="cosmic-deletions-and-targeted-panel-mutations.html"><a href="cosmic-deletions-and-targeted-panel-mutations.html"><i class="fa fa-check"></i><b>19</b> COSMIC deletions and targeted panel mutations</a>
<ul>
<li class="chapter" data-level="19.1" data-path="cosmic-deletions-and-targeted-panel-mutations.html"><a href="cosmic-deletions-and-targeted-panel-mutations.html#trrfer-specific-subclones"><i class="fa fa-check"></i><b>19.1</b> TRR/FER specific subclones</a></li>
<li class="chapter" data-level="19.2" data-path="cosmic-deletions-and-targeted-panel-mutations.html"><a href="cosmic-deletions-and-targeted-panel-mutations.html#variant-allele-frequency-snvs"><i class="fa fa-check"></i><b>19.2</b> Variant allele frequency SNVs</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="session-info.html"><a href="session-info.html"><i class="fa fa-check"></i><b>20</b> Session info</a>
<ul>
<li class="chapter" data-level="20.1" data-path="session-info.html"><a href="session-info.html#dockerfile"><i class="fa fa-check"></i><b>20.1</b> Dockerfile</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">High clonal diversity and spatial genetic admixture in early prostate cancer and surrounding normal tissue</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="individual-subclone-distribution-in-prostate" class="section level1 hasAnchor" number="15">
<h1><span class="header-section-number">15</span> Individual subclone distribution in prostate<a href="individual-subclone-distribution-in-prostate.html#individual-subclone-distribution-in-prostate" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This sections produces all the figures used in Supplementary Figure 11, 12, 13 and 14.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="individual-subclone-distribution-in-prostate.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Source setup file</span></span>
<span id="cb111-2"><a href="individual-subclone-distribution-in-prostate.html#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;./functions/setup.R&quot;</span>)</span>
<span id="cb111-3"><a href="individual-subclone-distribution-in-prostate.html#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="individual-subclone-distribution-in-prostate.html#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load functions</span></span>
<span id="cb111-5"><a href="individual-subclone-distribution-in-prostate.html#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;./functions/plotHeatmap.R&quot;</span>)</span>
<span id="cb111-6"><a href="individual-subclone-distribution-in-prostate.html#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;./functions/plotProfile.R&quot;</span>)</span></code></pre></div>
<div id="plotting-individual-subclone-distribution" class="section level2 hasAnchor" number="15.1">
<h2><span class="header-section-number">15.1</span> Plotting individual subclone distribution<a href="individual-subclone-distribution-in-prostate.html#plotting-individual-subclone-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here we plot, for each detected subclone, the distribution within the prostate. The scripts to obtain the list of subclones and the associated entropy is in the Rmd file for Figure 2. Once again, we do this first for P3.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="individual-subclone-distribution-in-prostate.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb112-2"><a href="individual-subclone-distribution-in-prostate.html#cb112-2" aria-hidden="true" tabindex="-1"></a>profiles <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">&quot;./data/P3_pseudodiploid_500kb.rds&quot;</span>)</span>
<span id="cb112-3"><a href="individual-subclone-distribution-in-prostate.html#cb112-3" aria-hidden="true" tabindex="-1"></a>clones <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">&quot;./data/subclones/P3_clones.tsv&quot;</span>)</span>
<span id="cb112-4"><a href="individual-subclone-distribution-in-prostate.html#cb112-4" aria-hidden="true" tabindex="-1"></a>annot <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">&quot;./annotation/P3.tsv&quot;</span>, <span class="at">header =</span> F)</span>
<span id="cb112-5"><a href="individual-subclone-distribution-in-prostate.html#cb112-5" aria-hidden="true" tabindex="-1"></a>entropy <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">&quot;./data/entropy/P3_entropy.tsv&quot;</span>)</span>
<span id="cb112-6"><a href="individual-subclone-distribution-in-prostate.html#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="individual-subclone-distribution-in-prostate.html#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Make copy of clones</span></span>
<span id="cb112-8"><a href="individual-subclone-distribution-in-prostate.html#cb112-8" aria-hidden="true" tabindex="-1"></a>clones_annot <span class="ot">=</span> <span class="fu">copy</span>(clones)</span>
<span id="cb112-9"><a href="individual-subclone-distribution-in-prostate.html#cb112-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-10"><a href="individual-subclone-distribution-in-prostate.html#cb112-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare cn profiles</span></span>
<span id="cb112-11"><a href="individual-subclone-distribution-in-prostate.html#cb112-11" aria-hidden="true" tabindex="-1"></a>profiles <span class="ot">=</span> profiles[, <span class="fu">c</span>(<span class="st">&quot;chr&quot;</span>, <span class="st">&quot;start&quot;</span>, <span class="st">&quot;end&quot;</span>, clones<span class="sc">$</span>sample_id), with <span class="ot">=</span> F]</span>
<span id="cb112-12"><a href="individual-subclone-distribution-in-prostate.html#cb112-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-13"><a href="individual-subclone-distribution-in-prostate.html#cb112-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Melt into long format and merge with clone information</span></span>
<span id="cb112-14"><a href="individual-subclone-distribution-in-prostate.html#cb112-14" aria-hidden="true" tabindex="-1"></a>profiles <span class="ot">=</span> <span class="fu">melt</span>(profiles, <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">&quot;chr&quot;</span>, <span class="st">&quot;start&quot;</span>, <span class="st">&quot;end&quot;</span>))</span>
<span id="cb112-15"><a href="individual-subclone-distribution-in-prostate.html#cb112-15" aria-hidden="true" tabindex="-1"></a>profiles <span class="ot">=</span> <span class="fu">merge</span>(profiles, clones, <span class="at">by.x =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;sample_id&quot;</span>)</span>
<span id="cb112-16"><a href="individual-subclone-distribution-in-prostate.html#cb112-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-17"><a href="individual-subclone-distribution-in-prostate.html#cb112-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Get consensus profiles</span></span>
<span id="cb112-18"><a href="individual-subclone-distribution-in-prostate.html#cb112-18" aria-hidden="true" tabindex="-1"></a>profiles <span class="ot">=</span> profiles[, .(<span class="at">cn =</span> <span class="fu">round</span>(<span class="fu">median</span>(value))), by <span class="ot">=</span> .(chr, start, end, cluster)]</span>
<span id="cb112-19"><a href="individual-subclone-distribution-in-prostate.html#cb112-19" aria-hidden="true" tabindex="-1"></a>profiles <span class="ot">=</span> <span class="fu">dcast</span>(profiles, chr<span class="sc">+</span>start<span class="sc">+</span>end <span class="sc">~</span> cluster, <span class="at">value.var =</span> <span class="st">&quot;cn&quot;</span>)</span>
<span id="cb112-20"><a href="individual-subclone-distribution-in-prostate.html#cb112-20" aria-hidden="true" tabindex="-1"></a>profiles <span class="ot">=</span> profiles[gtools<span class="sc">::</span><span class="fu">mixedorder</span>(profiles<span class="sc">$</span>chr)]</span>
<span id="cb112-21"><a href="individual-subclone-distribution-in-prostate.html#cb112-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-22"><a href="individual-subclone-distribution-in-prostate.html#cb112-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge clones with annotation data</span></span>
<span id="cb112-23"><a href="individual-subclone-distribution-in-prostate.html#cb112-23" aria-hidden="true" tabindex="-1"></a>clones[, library <span class="sc">:</span><span class="er">=</span> <span class="fu">gsub</span>(<span class="st">&quot;_.*&quot;</span>, <span class="st">&quot;&quot;</span>, sample_id)]</span>
<span id="cb112-24"><a href="individual-subclone-distribution-in-prostate.html#cb112-24" aria-hidden="true" tabindex="-1"></a>clones <span class="ot">=</span> <span class="fu">merge</span>(clones, annot, <span class="at">by.x =</span> <span class="st">&quot;library&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;V1&quot;</span>, <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb112-25"><a href="individual-subclone-distribution-in-prostate.html#cb112-25" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(clones, <span class="st">&quot;V2&quot;</span>, <span class="st">&quot;section&quot;</span>)</span>
<span id="cb112-26"><a href="individual-subclone-distribution-in-prostate.html#cb112-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-27"><a href="individual-subclone-distribution-in-prostate.html#cb112-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Get fraction of each subclone in each section</span></span>
<span id="cb112-28"><a href="individual-subclone-distribution-in-prostate.html#cb112-28" aria-hidden="true" tabindex="-1"></a>clones <span class="ot">=</span> clones[, .N, by <span class="ot">=</span> .(cluster, section)]</span>
<span id="cb112-29"><a href="individual-subclone-distribution-in-prostate.html#cb112-29" aria-hidden="true" tabindex="-1"></a>clones <span class="ot">=</span> clones[, .(<span class="at">count =</span> N, <span class="at">section =</span> section, <span class="at">fraction =</span> N <span class="sc">/</span> <span class="fu">sum</span>(N)), by <span class="ot">=</span> .(cluster)]</span>
<span id="cb112-30"><a href="individual-subclone-distribution-in-prostate.html#cb112-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-31"><a href="individual-subclone-distribution-in-prostate.html#cb112-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Add coordinates</span></span>
<span id="cb112-32"><a href="individual-subclone-distribution-in-prostate.html#cb112-32" aria-hidden="true" tabindex="-1"></a>clones[, x <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;L|C.&quot;</span>, <span class="st">&quot;&quot;</span>, section))]</span>
<span id="cb112-33"><a href="individual-subclone-distribution-in-prostate.html#cb112-33" aria-hidden="true" tabindex="-1"></a>clones[, y <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;L.|C&quot;</span>, <span class="st">&quot;&quot;</span>, section))]</span>
<span id="cb112-34"><a href="individual-subclone-distribution-in-prostate.html#cb112-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-35"><a href="individual-subclone-distribution-in-prostate.html#cb112-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill NAs</span></span>
<span id="cb112-36"><a href="individual-subclone-distribution-in-prostate.html#cb112-36" aria-hidden="true" tabindex="-1"></a>clones[, section <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="st">&quot;L&quot;</span>, x, <span class="st">&quot;C&quot;</span>, y)]</span>
<span id="cb112-37"><a href="individual-subclone-distribution-in-prostate.html#cb112-37" aria-hidden="true" tabindex="-1"></a>clones <span class="ot">=</span> clones <span class="sc">|&gt;</span> <span class="fu">complete</span>(section, cluster)</span>
<span id="cb112-38"><a href="individual-subclone-distribution-in-prostate.html#cb112-38" aria-hidden="true" tabindex="-1"></a><span class="fu">setDT</span>(clones)</span>
<span id="cb112-39"><a href="individual-subclone-distribution-in-prostate.html#cb112-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-40"><a href="individual-subclone-distribution-in-prostate.html#cb112-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Readd coordinates</span></span>
<span id="cb112-41"><a href="individual-subclone-distribution-in-prostate.html#cb112-41" aria-hidden="true" tabindex="-1"></a>clones[, x <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;L|C.&quot;</span>, <span class="st">&quot;&quot;</span>, section))]</span>
<span id="cb112-42"><a href="individual-subclone-distribution-in-prostate.html#cb112-42" aria-hidden="true" tabindex="-1"></a>clones[, y <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;L.|C&quot;</span>, <span class="st">&quot;&quot;</span>, section))]</span>
<span id="cb112-43"><a href="individual-subclone-distribution-in-prostate.html#cb112-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-44"><a href="individual-subclone-distribution-in-prostate.html#cb112-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through clones and combine the distribution heatmap and the genomewide heatmap</span></span>
<span id="cb112-45"><a href="individual-subclone-distribution-in-prostate.html#cb112-45" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">=</span> <span class="fu">lapply</span>(entropy<span class="sc">$</span>clone, <span class="cf">function</span>(clone) { </span>
<span id="cb112-46"><a href="individual-subclone-distribution-in-prostate.html#cb112-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot profile heatmap</span></span>
<span id="cb112-47"><a href="individual-subclone-distribution-in-prostate.html#cb112-47" aria-hidden="true" tabindex="-1"></a>  heatmap <span class="ot">=</span> <span class="fu">plotHeatmap</span>(profiles[, clone, <span class="at">with =</span> F], profiles[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">linesize =</span> <span class="dv">20</span>, <span class="at">dendrogram =</span> F, <span class="at">order =</span> clone, <span class="at">rast =</span> T) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb112-48"><a href="individual-subclone-distribution-in-prostate.html#cb112-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb112-49"><a href="individual-subclone-distribution-in-prostate.html#cb112-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Complete</span></span>
<span id="cb112-50"><a href="individual-subclone-distribution-in-prostate.html#cb112-50" aria-hidden="true" tabindex="-1"></a>  dt <span class="ot">=</span> clones[cluster <span class="sc">==</span> clone]</span>
<span id="cb112-51"><a href="individual-subclone-distribution-in-prostate.html#cb112-51" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">=</span>   </span>
<span id="cb112-52"><a href="individual-subclone-distribution-in-prostate.html#cb112-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(dt, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> fraction, <span class="at">label =</span> count)) <span class="sc">+</span></span>
<span id="cb112-53"><a href="individual-subclone-distribution-in-prostate.html#cb112-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb112-54"><a href="individual-subclone-distribution-in-prostate.html#cb112-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_text</span>() <span class="sc">+</span></span>
<span id="cb112-55"><a href="individual-subclone-distribution-in-prostate.html#cb112-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> clones_annot[cluster <span class="sc">==</span> clone, name]) <span class="sc">+</span></span>
<span id="cb112-56"><a href="individual-subclone-distribution-in-prostate.html#cb112-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_distiller</span>(<span class="at">name =</span> <span class="st">&quot;Subclone</span><span class="sc">\n</span><span class="st">Fraction&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Reds&quot;</span>, <span class="at">direction =</span> <span class="dv">1</span>, <span class="at">na.value =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb112-57"><a href="individual-subclone-distribution-in-prostate.html#cb112-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">5</span>, <span class="at">to =</span> <span class="fu">max</span>(dt<span class="sc">$</span>y), <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb112-58"><a href="individual-subclone-distribution-in-prostate.html#cb112-58" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">5</span>, <span class="at">to =</span> <span class="fu">max</span>(dt<span class="sc">$</span>x), <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb112-59"><a href="individual-subclone-distribution-in-prostate.html#cb112-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_reverse</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">max</span>(dt<span class="sc">$</span>y)), <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">max</span>(dt<span class="sc">$</span>y))) <span class="sc">+</span> </span>
<span id="cb112-60"><a href="individual-subclone-distribution-in-prostate.html#cb112-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_reverse</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">max</span>(dt<span class="sc">$</span>x)), <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">max</span>(dt<span class="sc">$</span>x))) <span class="sc">+</span></span>
<span id="cb112-61"><a href="individual-subclone-distribution-in-prostate.html#cb112-61" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb112-62"><a href="individual-subclone-distribution-in-prostate.html#cb112-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-63"><a href="individual-subclone-distribution-in-prostate.html#cb112-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine plots</span></span>
<span id="cb112-64"><a href="individual-subclone-distribution-in-prostate.html#cb112-64" aria-hidden="true" tabindex="-1"></a>  combined <span class="ot">=</span> <span class="fu">wrap_plots</span>(heatmap, plt, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.125</span>, <span class="dv">1</span>))</span>
<span id="cb112-65"><a href="individual-subclone-distribution-in-prostate.html#cb112-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(combined)</span>
<span id="cb112-66"><a href="individual-subclone-distribution-in-prostate.html#cb112-66" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb112-67"><a href="individual-subclone-distribution-in-prostate.html#cb112-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot everything at once</span></span>
<span id="cb112-68"><a href="individual-subclone-distribution-in-prostate.html#cb112-68" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(plots, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="co"># You can also plot 1 by 1 by not running this but simply running &#39;plots&#39;</span></span></code></pre></div>
<p><img src="_main_files/figure-html/plot%20distribution%20P3%20subclones-1.png" width="6912" /></p>
<p>And now for P6</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="individual-subclone-distribution-in-prostate.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb113-2"><a href="individual-subclone-distribution-in-prostate.html#cb113-2" aria-hidden="true" tabindex="-1"></a>profiles <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">&quot;./data/P6_pseudodiploid_500kb.rds&quot;</span>)</span>
<span id="cb113-3"><a href="individual-subclone-distribution-in-prostate.html#cb113-3" aria-hidden="true" tabindex="-1"></a>clones <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">&quot;./data/subclones//P6_clones.tsv&quot;</span>)</span>
<span id="cb113-4"><a href="individual-subclone-distribution-in-prostate.html#cb113-4" aria-hidden="true" tabindex="-1"></a>annot <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">&quot;./annotation/P6.tsv&quot;</span>, <span class="at">header =</span> F)</span>
<span id="cb113-5"><a href="individual-subclone-distribution-in-prostate.html#cb113-5" aria-hidden="true" tabindex="-1"></a>entropy <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">&quot;./data/entropy/P6_entropy.tsv&quot;</span>)</span>
<span id="cb113-6"><a href="individual-subclone-distribution-in-prostate.html#cb113-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-7"><a href="individual-subclone-distribution-in-prostate.html#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Make copy of clones</span></span>
<span id="cb113-8"><a href="individual-subclone-distribution-in-prostate.html#cb113-8" aria-hidden="true" tabindex="-1"></a>clones_annot <span class="ot">=</span> <span class="fu">copy</span>(clones)</span>
<span id="cb113-9"><a href="individual-subclone-distribution-in-prostate.html#cb113-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-10"><a href="individual-subclone-distribution-in-prostate.html#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare cn profiles</span></span>
<span id="cb113-11"><a href="individual-subclone-distribution-in-prostate.html#cb113-11" aria-hidden="true" tabindex="-1"></a>profiles <span class="ot">=</span> profiles[, <span class="fu">c</span>(<span class="st">&quot;chr&quot;</span>, <span class="st">&quot;start&quot;</span>, <span class="st">&quot;end&quot;</span>, clones<span class="sc">$</span>sample_id), with <span class="ot">=</span> F]</span>
<span id="cb113-12"><a href="individual-subclone-distribution-in-prostate.html#cb113-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-13"><a href="individual-subclone-distribution-in-prostate.html#cb113-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Melt into long format and merge with clone information</span></span>
<span id="cb113-14"><a href="individual-subclone-distribution-in-prostate.html#cb113-14" aria-hidden="true" tabindex="-1"></a>profiles <span class="ot">=</span> <span class="fu">melt</span>(profiles, <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">&quot;chr&quot;</span>, <span class="st">&quot;start&quot;</span>, <span class="st">&quot;end&quot;</span>))</span>
<span id="cb113-15"><a href="individual-subclone-distribution-in-prostate.html#cb113-15" aria-hidden="true" tabindex="-1"></a>profiles <span class="ot">=</span> <span class="fu">merge</span>(profiles, clones, <span class="at">by.x =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;sample_id&quot;</span>)</span>
<span id="cb113-16"><a href="individual-subclone-distribution-in-prostate.html#cb113-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-17"><a href="individual-subclone-distribution-in-prostate.html#cb113-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Get consensus profiles</span></span>
<span id="cb113-18"><a href="individual-subclone-distribution-in-prostate.html#cb113-18" aria-hidden="true" tabindex="-1"></a>profiles <span class="ot">=</span> profiles[, .(<span class="at">cn =</span> <span class="fu">round</span>(<span class="fu">median</span>(value))), by <span class="ot">=</span> .(chr, start, end, cluster)]</span>
<span id="cb113-19"><a href="individual-subclone-distribution-in-prostate.html#cb113-19" aria-hidden="true" tabindex="-1"></a>profiles <span class="ot">=</span> <span class="fu">dcast</span>(profiles, chr<span class="sc">+</span>start<span class="sc">+</span>end <span class="sc">~</span> cluster, <span class="at">value.var =</span> <span class="st">&quot;cn&quot;</span>)</span>
<span id="cb113-20"><a href="individual-subclone-distribution-in-prostate.html#cb113-20" aria-hidden="true" tabindex="-1"></a>profiles <span class="ot">=</span> profiles[gtools<span class="sc">::</span><span class="fu">mixedorder</span>(profiles<span class="sc">$</span>chr)]</span>
<span id="cb113-21"><a href="individual-subclone-distribution-in-prostate.html#cb113-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-22"><a href="individual-subclone-distribution-in-prostate.html#cb113-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge clones with annotation data</span></span>
<span id="cb113-23"><a href="individual-subclone-distribution-in-prostate.html#cb113-23" aria-hidden="true" tabindex="-1"></a>clones[, library <span class="sc">:</span><span class="er">=</span> <span class="fu">gsub</span>(<span class="st">&quot;_.*&quot;</span>, <span class="st">&quot;&quot;</span>, sample_id)]</span>
<span id="cb113-24"><a href="individual-subclone-distribution-in-prostate.html#cb113-24" aria-hidden="true" tabindex="-1"></a>clones <span class="ot">=</span> <span class="fu">merge</span>(clones, annot, <span class="at">by.x =</span> <span class="st">&quot;library&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;V1&quot;</span>, <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-25"><a href="individual-subclone-distribution-in-prostate.html#cb113-25" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(clones, <span class="st">&quot;V2&quot;</span>, <span class="st">&quot;section&quot;</span>)</span>
<span id="cb113-26"><a href="individual-subclone-distribution-in-prostate.html#cb113-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-27"><a href="individual-subclone-distribution-in-prostate.html#cb113-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Get fraction of each subclone in each section</span></span>
<span id="cb113-28"><a href="individual-subclone-distribution-in-prostate.html#cb113-28" aria-hidden="true" tabindex="-1"></a>clones <span class="ot">=</span> clones[, .N, by <span class="ot">=</span> .(cluster, section)]</span>
<span id="cb113-29"><a href="individual-subclone-distribution-in-prostate.html#cb113-29" aria-hidden="true" tabindex="-1"></a>clones <span class="ot">=</span> clones[, .(<span class="at">count =</span> N, <span class="at">section =</span> section, <span class="at">fraction =</span> N <span class="sc">/</span> <span class="fu">sum</span>(N)), by <span class="ot">=</span> .(cluster)]</span>
<span id="cb113-30"><a href="individual-subclone-distribution-in-prostate.html#cb113-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-31"><a href="individual-subclone-distribution-in-prostate.html#cb113-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Add coordinates</span></span>
<span id="cb113-32"><a href="individual-subclone-distribution-in-prostate.html#cb113-32" aria-hidden="true" tabindex="-1"></a>clones[, x <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;L|C.&quot;</span>, <span class="st">&quot;&quot;</span>, section))]</span>
<span id="cb113-33"><a href="individual-subclone-distribution-in-prostate.html#cb113-33" aria-hidden="true" tabindex="-1"></a>clones[, y <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;L.|C&quot;</span>, <span class="st">&quot;&quot;</span>, section))]</span>
<span id="cb113-34"><a href="individual-subclone-distribution-in-prostate.html#cb113-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-35"><a href="individual-subclone-distribution-in-prostate.html#cb113-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill NAs</span></span>
<span id="cb113-36"><a href="individual-subclone-distribution-in-prostate.html#cb113-36" aria-hidden="true" tabindex="-1"></a>clones[, section <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="st">&quot;L&quot;</span>, x, <span class="st">&quot;C&quot;</span>, y)]</span>
<span id="cb113-37"><a href="individual-subclone-distribution-in-prostate.html#cb113-37" aria-hidden="true" tabindex="-1"></a>clones <span class="ot">=</span> clones <span class="sc">|&gt;</span> <span class="fu">complete</span>(section, cluster)</span>
<span id="cb113-38"><a href="individual-subclone-distribution-in-prostate.html#cb113-38" aria-hidden="true" tabindex="-1"></a><span class="fu">setDT</span>(clones)</span>
<span id="cb113-39"><a href="individual-subclone-distribution-in-prostate.html#cb113-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-40"><a href="individual-subclone-distribution-in-prostate.html#cb113-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Readd coordinates</span></span>
<span id="cb113-41"><a href="individual-subclone-distribution-in-prostate.html#cb113-41" aria-hidden="true" tabindex="-1"></a>clones[, x <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;L|C.&quot;</span>, <span class="st">&quot;&quot;</span>, section))]</span>
<span id="cb113-42"><a href="individual-subclone-distribution-in-prostate.html#cb113-42" aria-hidden="true" tabindex="-1"></a>clones[, y <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;L.|C&quot;</span>, <span class="st">&quot;&quot;</span>, section))]</span>
<span id="cb113-43"><a href="individual-subclone-distribution-in-prostate.html#cb113-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-44"><a href="individual-subclone-distribution-in-prostate.html#cb113-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through clones and combine the distribution heatmap and the genomewide heatmap</span></span>
<span id="cb113-45"><a href="individual-subclone-distribution-in-prostate.html#cb113-45" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">=</span> <span class="fu">lapply</span>(entropy<span class="sc">$</span>clone, <span class="cf">function</span>(clone) { </span>
<span id="cb113-46"><a href="individual-subclone-distribution-in-prostate.html#cb113-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot profile heatmap</span></span>
<span id="cb113-47"><a href="individual-subclone-distribution-in-prostate.html#cb113-47" aria-hidden="true" tabindex="-1"></a>  heatmap <span class="ot">=</span> <span class="fu">plotHeatmap</span>(profiles[, clone, <span class="at">with =</span> F], profiles[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">linesize =</span> <span class="dv">20</span>, <span class="at">dendrogram =</span> F, <span class="at">order =</span> clone, <span class="at">rast =</span> T) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb113-48"><a href="individual-subclone-distribution-in-prostate.html#cb113-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-49"><a href="individual-subclone-distribution-in-prostate.html#cb113-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Complete</span></span>
<span id="cb113-50"><a href="individual-subclone-distribution-in-prostate.html#cb113-50" aria-hidden="true" tabindex="-1"></a>  dt <span class="ot">=</span> clones[cluster <span class="sc">==</span> clone]</span>
<span id="cb113-51"><a href="individual-subclone-distribution-in-prostate.html#cb113-51" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">=</span>   </span>
<span id="cb113-52"><a href="individual-subclone-distribution-in-prostate.html#cb113-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(dt, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> fraction, <span class="at">label =</span> count)) <span class="sc">+</span></span>
<span id="cb113-53"><a href="individual-subclone-distribution-in-prostate.html#cb113-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb113-54"><a href="individual-subclone-distribution-in-prostate.html#cb113-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_text</span>() <span class="sc">+</span></span>
<span id="cb113-55"><a href="individual-subclone-distribution-in-prostate.html#cb113-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> clones_annot[cluster <span class="sc">==</span> clone, name]) <span class="sc">+</span></span>
<span id="cb113-56"><a href="individual-subclone-distribution-in-prostate.html#cb113-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_distiller</span>(<span class="at">name =</span> <span class="st">&quot;Subclone</span><span class="sc">\n</span><span class="st">Fraction&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Reds&quot;</span>, <span class="at">direction =</span> <span class="dv">1</span>, <span class="at">na.value =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb113-57"><a href="individual-subclone-distribution-in-prostate.html#cb113-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">5</span>, <span class="at">to =</span> <span class="fu">max</span>(dt<span class="sc">$</span>y), <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb113-58"><a href="individual-subclone-distribution-in-prostate.html#cb113-58" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">5</span>, <span class="at">to =</span> <span class="fu">max</span>(dt<span class="sc">$</span>x), <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb113-59"><a href="individual-subclone-distribution-in-prostate.html#cb113-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_reverse</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">max</span>(dt<span class="sc">$</span>y)), <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">max</span>(dt<span class="sc">$</span>y))) <span class="sc">+</span> </span>
<span id="cb113-60"><a href="individual-subclone-distribution-in-prostate.html#cb113-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_reverse</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">max</span>(dt<span class="sc">$</span>x)), <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">max</span>(dt<span class="sc">$</span>x))) <span class="sc">+</span></span>
<span id="cb113-61"><a href="individual-subclone-distribution-in-prostate.html#cb113-61" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb113-62"><a href="individual-subclone-distribution-in-prostate.html#cb113-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-63"><a href="individual-subclone-distribution-in-prostate.html#cb113-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine plots</span></span>
<span id="cb113-64"><a href="individual-subclone-distribution-in-prostate.html#cb113-64" aria-hidden="true" tabindex="-1"></a>  combined <span class="ot">=</span> <span class="fu">wrap_plots</span>(heatmap, plt, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.125</span>, <span class="dv">1</span>))</span>
<span id="cb113-65"><a href="individual-subclone-distribution-in-prostate.html#cb113-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(combined)</span>
<span id="cb113-66"><a href="individual-subclone-distribution-in-prostate.html#cb113-66" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb113-67"><a href="individual-subclone-distribution-in-prostate.html#cb113-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot everything at once</span></span>
<span id="cb113-68"><a href="individual-subclone-distribution-in-prostate.html#cb113-68" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(plots, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="co"># You can also plot 1 by 1 by not running this but simply running &#39;plots&#39;</span></span></code></pre></div>
<p><img src="_main_files/figure-html/plot%20distribution%20P6%20subclones-1.png" width="6912" /></p>
<p>Now, for the top 5 most local (lowest entropy) subclones, we plot the individual copy number profiles for manual inspection.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="individual-subclone-distribution-in-prostate.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb114-2"><a href="individual-subclone-distribution-in-prostate.html#cb114-2" aria-hidden="true" tabindex="-1"></a>cnv <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">&quot;./data/P3_cnv.rds&quot;</span>)</span>
<span id="cb114-3"><a href="individual-subclone-distribution-in-prostate.html#cb114-3" aria-hidden="true" tabindex="-1"></a>clones <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">&quot;./data/subclones/P3_clones.tsv&quot;</span>)</span>
<span id="cb114-4"><a href="individual-subclone-distribution-in-prostate.html#cb114-4" aria-hidden="true" tabindex="-1"></a>entropy <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">&quot;./data/entropy/P3_entropy.tsv&quot;</span>)</span>
<span id="cb114-5"><a href="individual-subclone-distribution-in-prostate.html#cb114-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-6"><a href="individual-subclone-distribution-in-prostate.html#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Select top 5 clones</span></span>
<span id="cb114-7"><a href="individual-subclone-distribution-in-prostate.html#cb114-7" aria-hidden="true" tabindex="-1"></a>top5 <span class="ot">=</span> entropy[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, name]</span>
<span id="cb114-8"><a href="individual-subclone-distribution-in-prostate.html#cb114-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-9"><a href="individual-subclone-distribution-in-prostate.html#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Select profiles</span></span>
<span id="cb114-10"><a href="individual-subclone-distribution-in-prostate.html#cb114-10" aria-hidden="true" tabindex="-1"></a>top_profiles <span class="ot">=</span> clones[name <span class="sc">%in%</span> top5, sample_id]</span>
<span id="cb114-11"><a href="individual-subclone-distribution-in-prostate.html#cb114-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-12"><a href="individual-subclone-distribution-in-prostate.html#cb114-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through profiles and plot</span></span>
<span id="cb114-13"><a href="individual-subclone-distribution-in-prostate.html#cb114-13" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">=</span> <span class="fu">lapply</span>(top_profiles, <span class="cf">function</span>(x) {</span>
<span id="cb114-14"><a href="individual-subclone-distribution-in-prostate.html#cb114-14" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">=</span> <span class="fu">plotProfile</span>(cnv<span class="sc">$</span>copynumber[[x]], cnv<span class="sc">$</span>counts_gc[[x]] <span class="sc">*</span> cnv<span class="sc">$</span>ploidies[sample <span class="sc">==</span> x, ploidy], <span class="at">bins =</span> cnv<span class="sc">$</span>bins) <span class="sc">+</span> </span>
<span id="cb114-15"><a href="individual-subclone-distribution-in-prostate.html#cb114-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(clones[sample_id <span class="sc">==</span> x, name], <span class="st">&quot; - &quot;</span>, x))</span>
<span id="cb114-16"><a href="individual-subclone-distribution-in-prostate.html#cb114-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(plt)</span>
<span id="cb114-17"><a href="individual-subclone-distribution-in-prostate.html#cb114-17" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb114-18"><a href="individual-subclone-distribution-in-prostate.html#cb114-18" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(plots, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/plot%20Profiles%20P3-1.png" width="3840" /></p>
<p>And repeat for P6.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="individual-subclone-distribution-in-prostate.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb115-2"><a href="individual-subclone-distribution-in-prostate.html#cb115-2" aria-hidden="true" tabindex="-1"></a>cnv <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">&quot;./data/P6_cnv.rds&quot;</span>)</span>
<span id="cb115-3"><a href="individual-subclone-distribution-in-prostate.html#cb115-3" aria-hidden="true" tabindex="-1"></a>clones <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">&quot;./data/subclones/P6_clones.tsv&quot;</span>)</span>
<span id="cb115-4"><a href="individual-subclone-distribution-in-prostate.html#cb115-4" aria-hidden="true" tabindex="-1"></a>entropy <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">&quot;./data/entropy/P6_entropy.tsv&quot;</span>)</span>
<span id="cb115-5"><a href="individual-subclone-distribution-in-prostate.html#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="individual-subclone-distribution-in-prostate.html#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Select top 5 clones</span></span>
<span id="cb115-7"><a href="individual-subclone-distribution-in-prostate.html#cb115-7" aria-hidden="true" tabindex="-1"></a>top5 <span class="ot">=</span> entropy[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, name]</span>
<span id="cb115-8"><a href="individual-subclone-distribution-in-prostate.html#cb115-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-9"><a href="individual-subclone-distribution-in-prostate.html#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Select profiles</span></span>
<span id="cb115-10"><a href="individual-subclone-distribution-in-prostate.html#cb115-10" aria-hidden="true" tabindex="-1"></a>top_profiles <span class="ot">=</span> clones[name <span class="sc">%in%</span> top5, sample_id]</span>
<span id="cb115-11"><a href="individual-subclone-distribution-in-prostate.html#cb115-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-12"><a href="individual-subclone-distribution-in-prostate.html#cb115-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through profiles and plot</span></span>
<span id="cb115-13"><a href="individual-subclone-distribution-in-prostate.html#cb115-13" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">=</span> <span class="fu">lapply</span>(top_profiles, <span class="cf">function</span>(x) {</span>
<span id="cb115-14"><a href="individual-subclone-distribution-in-prostate.html#cb115-14" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">=</span> <span class="fu">plotProfile</span>(cnv<span class="sc">$</span>copynumber[[x]], cnv<span class="sc">$</span>counts_gc[[x]] <span class="sc">*</span> cnv<span class="sc">$</span>ploidies[sample <span class="sc">==</span> x, ploidy], <span class="at">bins =</span> cnv<span class="sc">$</span>bins) <span class="sc">+</span> </span>
<span id="cb115-15"><a href="individual-subclone-distribution-in-prostate.html#cb115-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(clones[sample_id <span class="sc">==</span> x, name], <span class="st">&quot; - &quot;</span>, x))</span>
<span id="cb115-16"><a href="individual-subclone-distribution-in-prostate.html#cb115-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(plt)</span>
<span id="cb115-17"><a href="individual-subclone-distribution-in-prostate.html#cb115-17" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb115-18"><a href="individual-subclone-distribution-in-prostate.html#cb115-18" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(plots, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/plot%20Profiles%20P6-1.png" width="3840" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="subclonal-distribution-in-prostate.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="monster-cells.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
